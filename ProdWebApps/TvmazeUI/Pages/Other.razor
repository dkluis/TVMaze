@namespace TvmazeUI.Pages
@page "/other"

@inject DataExchange      DataExchangeService

@code {
    private static readonly AppInfo AppInfo = new("Tvmaze", "WebUI", "DbAlternate");

    private void DeleteActionItem(ActionItem rec)
    {
        AppInfo.TxtFile.Write($"Deleting ActionItem {rec.Id}: {rec.Program}: {rec.Message}");
        ActionItemModel.DeleteActionItem(rec, AppInfo.Program, AppInfo.TxtFile);
    }
}

@{
    DataExchangeService.LastPage = "Other";
    var result      = ActionItemModel.GetAllActionItems();
    var actionItems = new List<ActionItem>();

    if (result != null && result.ResponseObject != null)
        actionItems = (List<ActionItem>) result.ResponseObject!;
}

<h1>Other</h1>

<div>
    @*<button class="btn btn-info" @onclick="GetTheMovies">Refresh Other</button>*@
    @*<button class="btn btn-primary" @onclick="GetTheMovies">Add Movie</button>*@
    <p></p>
</div>

<div>
    <p></p>
    <h6>Action Item - Table</h6>
    <p></p>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Id</th>
            <th>Program</th>
            <th>Message</th>
            <th>DateTime</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        @{
            foreach (var rec in actionItems)
            {
                <tr>
                    <td>@rec.Id</td>
                    <td>@rec.Program</td>
                    <td>@rec.Message</td>
                    <td>@rec.UpdateDateTime</td>
                    <button class="btn btn-danger" @onclick="@(() => DeleteActionItem(rec))">Delete</button>
                </tr>
            }
        }
        </tbody>
    </table>
</div>
